#!/bin/bash
. $(dirname $0)/functions

echo "Assembling image using s2i-java-binary..."

echo "Installing Oracle JDK 9"
if [[ -n "$ORACLE_JDK_9" ]]; then
  wget --no-cookies --no-check-certificate --header "Cookie: oraclelicense=accept-securebackup-cookie" \
  http://download.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.rpm -O jdk-9_linux-x64_bin.rpm

  rpm -ivh jdk-9_linux-x64_bin.rpm
fi

echo "Printing out Java version"
java -version

echo "Copying /tmp/src into /opt/openshift"
mkdir -p /opt/openshift
cp -rvf /tmp/src/* /opt/openshift
chmod -R 777 /opt/openshift

if [[ -f /opt/openshift/run.sh ]]; then
  chmod +x /opt/openshift/run.sh
fi

exit 0
